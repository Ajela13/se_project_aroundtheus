!function(){"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}_hideInputError(e){this._errorElement=this._formElement.querySelector(`.${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorElement.textContent=" ",this._errorElement.classList.remove(this._errorClass)}_showInputError(e,t){this._errorElement=this._formElement.querySelector(`.${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorElement.textContent=t,this._errorElement.classList.add(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}_disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0}_enableButton(){this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1}_toggleButtonState(e){this._hasInvalidInput(e)?this.disableButton(this._buttonElement):this._enableButton(this._buttonElement)}_setEventListener(){this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector),this._toggleButtonState(this._inputList),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState(this._inputList)}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListener()}disableButton(){this._disableButton()}enableButton(){this._enableButton()}}class t{constructor(e,t,r,s,i){this._data=e,this._name=e.name,this._link=e.link,this._alt=e.alt,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=document.querySelector(t).content.firstElementChild,this._handleDeleteCard=s,this._handleLikeCard=i,this._handleImageClick=r,this._cardElement=this._cardSelector.cloneNode(!0),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardNameEl=this._cardElement.querySelector(".card__description-name"),this._deleteButton=this._cardElement.querySelector(".card__trash"),this._likeButton=this._cardElement.querySelector(".card__like-button")}_setEventListeners(){this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._data)})),this._deleteButton.addEventListener("click",(()=>this._handleDeleteCard(this))),this._likeButton.addEventListener("click",(()=>this._handleLikeCard(this)))}handleDeleteButton(){this._cardElement.remove(),this._cardElement=null}handleLikeButton(e){this._isLiked=e,this._likeButton.classList.toggle("card__like-button_active")}_updateLikeIcon(){this._isLiked&&this.handleLikeButton(this._isLiked)}getCardElement(){return this._cardImageElement.src=this._link,this._cardNameEl.textContent=this._name,this._cardImageElement.alt=this._alt,this._setEventListeners(),this._updateLikeIcon(),this._cardElement}getId(){return this._id}isLiked(){return this._isLiked}}class r{constructor(e,t){let{items:r,renderer:s}=e;this._items=r,this._renderer=s,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>this.addInitialItems(e)))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}addInitialItems(e){const t=this._renderer(e);this._container.append(t)}}class s{constructor(e){this._modal=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._modal.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modal.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._modal.addEventListener("click",(e=>{e.target.classList.contains("modal__close")&&this.close(),e.target.classList.contains("modal")&&this.close()}))}}class i extends s{constructor(e,t){super(e),this._modalForm=this._modal.querySelector(".modal__form"),this._modalButton=this._modal.querySelector(".form__button"),this._handleFormSubmit=t,this._inputList=this._modalForm.querySelectorAll(".form__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setLoading(e,t){this._modalButton.textContent=e?"Saving...":t}setEventListeners(){this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()})),super.setEventListeners()}}const n=document.querySelector("#profile-edit-button"),o=document.forms["modal-edit-form"],a=document.querySelector("#profile-edit-title"),l=document.querySelector("#profile-edit-description"),d=document.querySelector("#profile-add-button"),c=document.forms["modal-add-form"],h=document.querySelector("#profile-edit-avatar-button"),u=document.forms["modal-edit-avatar-form"],m=document.forms["modal-confirmation-form"];document.querySelector("#confirmation-button");const _=new class{constructor(){this.baseUrl="https://around-api.en.tripleten-services.com/v1",this.header={authorization:"4a267eba-b438-44d7-b955-12a5629fdd41","Content-Type":"application/json"}}_request(e,t){return fetch(e,t).then(this._checkRes)}_checkRes(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getUserInfo(){return this._request(`${this.baseUrl}/users/me`,{headers:this.header})}updateProfileInfo(e,t){return this._request(`${this.baseUrl}/users/me`,{headers:this.header,method:"PATCH",body:JSON.stringify({name:e,about:t})})}updateProfileAvatar(e){return this._request(`${this.baseUrl}/users/me/avatar`,{headers:this.header,method:"PATCH",body:JSON.stringify({avatar:e})})}getInitialCards(){return this._request(`${this.baseUrl}/cards`,{headers:this.header})}postCard(e,t){return this._request(`${this.baseUrl}/cards`,{headers:this.header,method:"POST",body:JSON.stringify({name:e,link:t})})}deleteCard(e){return this._request(`${this.baseUrl}/cards/${e}`,{headers:this.header,method:"DELETE"})}likeCard(e){return this._request(`${this.baseUrl}/cards/${e}/likes`,{headers:this.header,method:"PUT"})}dislikeCard(e){return this._request(`${this.baseUrl}/cards/${e}/likes`,{headers:this.header,method:"DELETE"})}},f=new class{constructor(e,t,r){this._profileTitleElement=document.querySelector(e),this._profileDescriptionElement=document.querySelector(t),this._profileAvatarElement=document.querySelector(r)}getUserInfo(){return{title:this._profileTitleElement.textContent,description:this._profileDescriptionElement.textContent.trim()}}setUserInfo(e){let{title:t,description:r}=e;this._profileTitleElement.textContent=t,this._profileDescriptionElement.textContent=r}setUserAvatar(e){let{avatar:t}=e;this._profileAvatarElement.src=t}}("#profile-title","#profile-description","#profile-avatar"),p=new i("#profile-add-modal",(function(e){p.setLoading(!0,"Create");const t=e.title,r=e["Image-link"];_.postCard(t,r).then((e=>{g.addItem(e),p.close()})).catch((e=>{console.error("Error fetching user info:",e)})).finally((()=>{p.setLoading(!1,"Create"),c.reset(),I["modal-add-form"].disableButton()}))})),E=new i("#profile-edit-modal",(function(e){E.setLoading(!0,"Save"),_.updateProfileInfo(e.title,e.description).then((e=>(f.setUserInfo({title:e.name,description:e.about}),E.close(),e))).catch((e=>{console.error("Error fetching user info:",e)})).finally((()=>{E.setLoading(!1,"Save"),o.reset(),I["modal-edit-form"].disableButton()}))})),v=new i("#profile-edit-avatar-modal",(function(e){v.setLoading(!0,"Save"),_.updateProfileAvatar(e.avatar).then((e=>(f.setUserAvatar({avatar:e.avatar}),v.close(),e))).catch((e=>{console.error("Error fetching user info:",e)})).finally((()=>{v.setLoading(!1,"Save"),u.reset(),I["modal-edit-avatar-form"].disableButton()}))})),L=new class extends s{constructor(e){super(e),this._confirmationModalForm=this._modal.querySelector(".modal__form")}setSubmitAction(e){this._submitAction=e}setEventListeners(){super.setEventListeners(),this._confirmationModalForm.addEventListener("submit",(e=>{e.preventDefault(),this._submitAction()}))}}("#confirmation-modal"),b=new class extends s{constructor(e){super(e),this._previewImage=this._modal.querySelector(".modal__image"),this._previewImageDescription=this._modal.querySelector(".preview_modal_description")}open(e){this._previewImage.src=e.link,this._previewImageDescription.textContent=e.name,this._previewImage.alt=e.alt,super.open()}}("#preview_image_modal");let g;function S(e){L.open(),L.setSubmitAction((()=>{_.deleteCard(e._id).then((()=>{e.handleDeleteButton()})).catch((e=>{console.error("Error fetching user info:",e)})).finally((()=>{m.reset(),I["modal-confirmation-form"].enableButton()}))}))}function C(e){e.isLiked()?_.dislikeCard(e.getId()).then((t=>{e.handleLikeButton(!1)})).catch((e=>{console.error("Error fetching user info:",e)})):_.likeCard(e.getId()).then((()=>{e.handleLikeButton(!0)})).catch((e=>{console.error("Error fetching user info:",e)}))}function k(e){b.open(e)}function y(e){return new t(e,"#card-template",k,S,C).getCardElement()}_.getUserInfo().then((e=>(f.setUserInfo({title:e.name,description:e.about}),f.setUserAvatar({avatar:e.avatar}),e))).catch((e=>{console.error("Error fetching user info:",e)})),_.getInitialCards().then((e=>{g=new r({items:e,renderer:y},".cards__list"),g.renderItems()})).catch((e=>{console.error("Error fetching user info:",e)})),n.addEventListener("click",(()=>{const e=f.getUserInfo();a.value=e.title,l.value=e.description,E.open()})),E.setEventListeners(),d.addEventListener("click",(()=>p.open())),p.setEventListeners(),h.addEventListener("click",(()=>v.open())),v.setEventListeners(),L.setEventListeners(),b.setEventListeners();const I={};var B;B={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"},Array.from(document.querySelectorAll(B.formSelector)).forEach((t=>{const r=new e(B,t),s=t.getAttribute("name");I[s]=r,r.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eUIsU0FBU3hCLGlCQUFpQjFDLEVBQU9nTixlQUNwRHJLLFNBQVMxQyxJQUNoQixNQUFNZ04sRUFBWSxJQUFJbk4sRUFBY0UsRUFBUUMsR0FDdENpTixFQUFXak4sRUFBWWtOLGFBQWEsUUFFMUNwQixFQUFlbUIsR0FBWUQsRUFDM0JBLEVBQVVwSyxrQkFBa0IsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvTW9kYWxXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Nb2RhbFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL01vZGFsV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBjb25maWcuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gY29uZmlnLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCIgXCI7XHJcbiAgICB0aGlzLl9lcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgdGhpcy5fZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIHRoaXMuX2Vycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbih0aGlzLl9idXR0b25FbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbih0aGlzLl9idXR0b25FbGVtZW50KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVyKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0TGlzdCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dExpc3QpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcigpO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZCxcclxuICAgIGhhbmRsZUxpa2VDYXJkXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fYWx0ID0gZGF0YS5hbHQ7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY2FyZFNlbGVjdG9yKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IGhhbmRsZURlbGV0ZUNhcmQ7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2FyZCA9IGhhbmRsZUxpa2VDYXJkO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRTZWxlY3Rvci5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50ID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmROYW1lRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5jYXJkX19kZXNjcmlwdGlvbi1uYW1lXCJcclxuICAgICk7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RyYXNoXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fZGF0YSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcylcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlTGlrZUNhcmQodGhpcylcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVEZWxldGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIGhhbmRsZUxpa2VCdXR0b24oaXNMaWtlZCkge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBfdXBkYXRlTGlrZUljb24oKSB7XHJcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICB0aGlzLmhhbmRsZUxpa2VCdXR0b24odGhpcy5faXNMaWtlZCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkRWxlbWVudCgpIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmROYW1lRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9hbHQ7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZUljb24oKTtcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIGdldElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5hZGRJbml0aWFsSXRlbXMoaXRlbSkpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICBjb25zdCBuZXdDYXJkID0gdGhpcy5fcmVuZGVyZXIoZWxlbWVudCk7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChuZXdDYXJkKTtcclxuICB9XHJcbiAgYWRkSW5pdGlhbEl0ZW1zKGVsZW1lbnQpIHtcclxuICAgIGNvbnN0IG5ld0NhcmQgPSB0aGlzLl9yZW5kZXJlcihlbGVtZW50KTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQobmV3Q2FyZCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9tb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbW9kYWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhGb3JtIGV4dGVuZHMgTW9kYWwge1xyXG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX21vZGFsQnV0dG9uID0gdGhpcy5fbW9kYWwucXVlcnlTZWxlY3RvcihcIi5mb3JtX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX21vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLmZvcm1fX2lucHV0XCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldExvYWRpbmcoaXNMb2FkaW5nLCB0ZXh0KSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX21vZGFsQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX21vZGFsQnV0dG9uLnRleHRDb250ZW50ID0gdGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgICBhbHQ6IFwiWW9zZW1pdGUgcGljdHVyZVwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gICAgYWx0OiBcIkxha2UgcGljdHVyZVwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gICAgYWx0OiBcIkJhbGQgcGljdHVyZVwiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICAgIGFsdDogXCJMYXRlbWFyIHBpY3R1cmVcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICAgIGFsdDogXCJWYW5vaXNlIHBpY3R1cmVcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gICAgYWx0OiBcIkxhZ28gcGljdHVyZVwiLFxyXG4gIH0sXHJcbl07XHJcblxyXG4vLyBFbGVtZW50c1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJtb2RhbC1lZGl0LWZvcm1cIl07XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC10aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWVkaXQtZGVzY3JpcHRpb25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm1vZGFsLWFkZC1mb3JtXCJdO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWVkaXQtYXZhdGFyLWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcIm1vZGFsLWVkaXQtYXZhdGFyLWZvcm1cIl07XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlybWF0aW9uRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wibW9kYWwtY29uZmlybWF0aW9uLWZvcm1cIl07XHJcbmV4cG9ydCBjb25zdCBjb25maXJtYXRpb25Gb3JtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNjb25maXJtYXRpb24tYnV0dG9uXCJcclxuKTtcclxuXHJcbi8vIFZhbGlkYXRpb25cclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLmZvcm1fX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcImZvcm1fX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IE1vZGFsV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgTW9kYWxXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcbmltcG9ydCB7XHJcbiAgaW5pdGlhbENhcmRzLFxyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVUaXRsZUlucHV0LFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxyXG4gIHByb2ZpbGVBZGRCdXR0b24sXHJcbiAgcHJvZmlsZUFkZEZvcm0sXHJcbiAgdmFsaWRhdGlvbkNvbmZpZyxcclxuICBwcm9maWxlRWRpdEF2YXRhckJ1dHRvbixcclxuICBwcm9maWxlRWRpdEF2YXRhckZvcm0sXHJcbiAgcHJvZmlsZUVkaXRGb3JtLFxyXG4gIGNvbmZpcm1hdGlvbkZvcm1CdXR0b24sXHJcbiAgY29uZmlybWF0aW9uRm9ybSxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBNb2RhbFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvTW9kYWxXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKCk7XHJcbmNvbnN0IHVzZXJJbmZvQ2xhc3MgPSBuZXcgVXNlckluZm8oXHJcbiAgXCIjcHJvZmlsZS10aXRsZVwiLFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb25cIixcclxuICBcIiNwcm9maWxlLWF2YXRhclwiXHJcbik7XHJcbmNvbnN0IHByb2ZpbGVBZGRNb2RhbENsYXNzID0gbmV3IE1vZGFsV2l0aEZvcm0oXHJcbiAgXCIjcHJvZmlsZS1hZGQtbW9kYWxcIixcclxuICBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdFxyXG4pO1xyXG5jb25zdCBwcm9maWxlRWRpdE1vZGFsQ2xhc3MgPSBuZXcgTW9kYWxXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdFxyXG4pO1xyXG5jb25zdCBwcm9maWxlRWRpdEF2YXRhck1vZGFsQ2xhc3MgPSBuZXcgTW9kYWxXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtYXZhdGFyLW1vZGFsXCIsXHJcbiAgaGFuZGxlUHJvZmlsZUF2YXRhclxyXG4pO1xyXG5cclxuY29uc3QgY29uZmlybWF0aW9uTW9kYWxDbGFzcyA9IG5ldyBNb2RhbFdpdGhDb25maXJtYXRpb24oXCIjY29uZmlybWF0aW9uLW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3SW1hZ2VNb2RhbENsYXNzID0gbmV3IE1vZGFsV2l0aEltYWdlKFwiI3ByZXZpZXdfaW1hZ2VfbW9kYWxcIik7XHJcblxyXG4vLyBHRVQgQVBJXHJcblxyXG5hcGlcclxuICAuZ2V0VXNlckluZm8oKVxyXG4gIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICB1c2VySW5mb0NsYXNzLnNldFVzZXJJbmZvKHsgdGl0bGU6IGRhdGEubmFtZSwgZGVzY3JpcHRpb246IGRhdGEuYWJvdXQgfSk7XHJcbiAgICB1c2VySW5mb0NsYXNzLnNldFVzZXJBdmF0YXIoe1xyXG4gICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGRhdGE7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvOlwiLCBlcnJvcik7XHJcbiAgfSk7XHJcblxyXG5sZXQgc2VjdGlvbkNsYXNzO1xyXG5cclxuYXBpXHJcbiAgLmdldEluaXRpYWxDYXJkcygpXHJcbiAgLnRoZW4oKGNhcmRMaXN0KSA9PiB7XHJcbiAgICBzZWN0aW9uQ2xhc3MgPSBuZXcgU2VjdGlvbihcclxuICAgICAgeyBpdGVtczogY2FyZExpc3QsIHJlbmRlcmVyOiBjcmVhdGVDYXJkIH0sXHJcbiAgICAgIFwiLmNhcmRzX19saXN0XCJcclxuICAgICk7XHJcbiAgICBzZWN0aW9uQ2xhc3MucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGluZm86XCIsIGVycm9yKTtcclxuICB9KTtcclxuXHJcbi8vIFBBVENIIEFQSVxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChmb3JtRGF0YSkge1xyXG4gIHByb2ZpbGVFZGl0TW9kYWxDbGFzcy5zZXRMb2FkaW5nKHRydWUsIFwiU2F2ZVwiKTtcclxuICBhcGlcclxuICAgIC51cGRhdGVQcm9maWxlSW5mbyhmb3JtRGF0YS50aXRsZSwgZm9ybURhdGEuZGVzY3JpcHRpb24pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICB1c2VySW5mb0NsYXNzLnNldFVzZXJJbmZvKHsgdGl0bGU6IGRhdGEubmFtZSwgZGVzY3JpcHRpb246IGRhdGEuYWJvdXQgfSk7XHJcbiAgICAgIHByb2ZpbGVFZGl0TW9kYWxDbGFzcy5jbG9zZSgpO1xyXG5cclxuICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvOlwiLCBlcnJvcik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlRWRpdE1vZGFsQ2xhc3Muc2V0TG9hZGluZyhmYWxzZSwgXCJTYXZlXCIpO1xyXG4gICAgICBwcm9maWxlRWRpdEZvcm0ucmVzZXQoKTtcclxuICAgICAgZm9ybVZhbGlkYXRvcnNbXCJtb2RhbC1lZGl0LWZvcm1cIl0uZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVBdmF0YXIoZm9ybURhdGEpIHtcclxuICBwcm9maWxlRWRpdEF2YXRhck1vZGFsQ2xhc3Muc2V0TG9hZGluZyh0cnVlLCBcIlNhdmVcIik7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlUHJvZmlsZUF2YXRhcihmb3JtRGF0YS5hdmF0YXIpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICB1c2VySW5mb0NsYXNzLnNldFVzZXJBdmF0YXIoe1xyXG4gICAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXIsXHJcbiAgICAgIH0pO1xyXG4gICAgICBwcm9maWxlRWRpdEF2YXRhck1vZGFsQ2xhc3MuY2xvc2UoKTtcclxuICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvOlwiLCBlcnJvcik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwcm9maWxlRWRpdEF2YXRhck1vZGFsQ2xhc3Muc2V0TG9hZGluZyhmYWxzZSwgXCJTYXZlXCIpO1xyXG4gICAgICBwcm9maWxlRWRpdEF2YXRhckZvcm0ucmVzZXQoKTtcclxuICAgICAgZm9ybVZhbGlkYXRvcnNbXCJtb2RhbC1lZGl0LWF2YXRhci1mb3JtXCJdLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vL1BPU1QgQVBJXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KG9iaikge1xyXG4gIHByb2ZpbGVBZGRNb2RhbENsYXNzLnNldExvYWRpbmcodHJ1ZSwgXCJDcmVhdGVcIik7XHJcbiAgY29uc3QgbmFtZSA9IG9ialtcInRpdGxlXCJdO1xyXG4gIGNvbnN0IGxpbmsgPSBvYmpbXCJJbWFnZS1saW5rXCJdO1xyXG4gIGFwaVxyXG4gICAgLnBvc3RDYXJkKG5hbWUsIGxpbmspXHJcbiAgICAudGhlbigoY2FyZCkgPT4ge1xyXG4gICAgICBzZWN0aW9uQ2xhc3MuYWRkSXRlbShjYXJkKTtcclxuICAgICAgcHJvZmlsZUFkZE1vZGFsQ2xhc3MuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGluZm86XCIsIGVycm9yKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVBZGRNb2RhbENsYXNzLnNldExvYWRpbmcoZmFsc2UsIFwiQ3JlYXRlXCIpO1xyXG4gICAgICBwcm9maWxlQWRkRm9ybS5yZXNldCgpO1xyXG4gICAgICBmb3JtVmFsaWRhdG9yc1tcIm1vZGFsLWFkZC1mb3JtXCJdLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vL0RFTEVURSBBUElcclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkKSB7XHJcbiAgY29uZmlybWF0aW9uTW9kYWxDbGFzcy5vcGVuKCk7XHJcbiAgY29uZmlybWF0aW9uTW9kYWxDbGFzcy5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuX2lkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5oYW5kbGVEZWxldGVCdXR0b24oKTtcclxuICAgICAgfSlcclxuXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgdXNlciBpbmZvOlwiLCBlcnJvcik7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBjb25maXJtYXRpb25Gb3JtLnJlc2V0KCk7XHJcbiAgICAgICAgZm9ybVZhbGlkYXRvcnNbXCJtb2RhbC1jb25maXJtYXRpb24tZm9ybVwiXS5lbmFibGVCdXR0b24oKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vUFVUIEFQSSAvIERFTEVURVxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2FyZChjYXJkKSB7XHJcbiAgaWYgKGNhcmQuaXNMaWtlZCgpKSB7XHJcbiAgICBhcGlcclxuICAgICAgLmRpc2xpa2VDYXJkKGNhcmQuZ2V0SWQoKSlcclxuICAgICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgICBjYXJkLmhhbmRsZUxpa2VCdXR0b24oZmFsc2UpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGluZm86XCIsIGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgLy9kaXNsaWtlXHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaVxyXG4gICAgICAubGlrZUNhcmQoY2FyZC5nZXRJZCgpKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5oYW5kbGVMaWtlQnV0dG9uKHRydWUpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGluZm86XCIsIGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuLy9GdW5jdGlvbnNcclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhjYXJkRGF0YSkge1xyXG4gIHByZXZpZXdJbWFnZU1vZGFsQ2xhc3Mub3BlbihjYXJkRGF0YSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoaXRlbSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXHJcbiAgICBpdGVtLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQsXHJcbiAgICBoYW5kbGVMaWtlQ2FyZFxyXG4gICk7XHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50LmdldENhcmRFbGVtZW50KCk7XHJcbn1cclxuXHJcbi8vIEV2ZW50IExpc3RlbmVyc1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB1c2VyRGF0YSA9IHVzZXJJbmZvQ2xhc3MuZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLnRpdGxlO1xyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdXNlckRhdGEuZGVzY3JpcHRpb247XHJcbiAgcHJvZmlsZUVkaXRNb2RhbENsYXNzLm9wZW4oKTtcclxufSk7XHJcblxyXG5wcm9maWxlRWRpdE1vZGFsQ2xhc3Muc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHByb2ZpbGVBZGRNb2RhbENsYXNzLm9wZW4oKSk7XHJcblxyXG5wcm9maWxlQWRkTW9kYWxDbGFzcy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxucHJvZmlsZUVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgcHJvZmlsZUVkaXRBdmF0YXJNb2RhbENsYXNzLm9wZW4oKVxyXG4pO1xyXG5cclxucHJvZmlsZUVkaXRBdmF0YXJNb2RhbENsYXNzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25maXJtYXRpb25Nb2RhbENsYXNzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5wcmV2aWV3SW1hZ2VNb2RhbENsYXNzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW1lbnQpO1xyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG5cclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25Db25maWcpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5iYXNlVXJsID0gXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiO1xyXG4gICAgdGhpcy5oZWFkZXIgPSB7XHJcbiAgICAgIGF1dGhvcml6YXRpb246IFwiNGEyNjdlYmEtYjQzOC00NGQ3LWI5NTUtMTJhNTYyOWZkZDQxXCIsXHJcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlcyk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXMocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZUluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyLFxyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBuYW1lLCBhYm91dCB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZUF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcixcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcG9zdENhcmQobmFtZSwgbGluaykge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXIsXHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcixcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcixcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkaXNsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcixcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByb2ZpbGVUaXRsZVNlbGVjdG9yLFxyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3IsXHJcbiAgICBwcm9maWxlQXZhdGFyU2VsZWN0b3JcclxuICApIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVUaXRsZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVUaXRsZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlQXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB0aXRsZTogdGhpcy5fcHJvZmlsZVRpdGxlRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQudHJpbSgpLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgdGl0bGUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aXRsZTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhckVsZW1lbnQuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgTW9kYWwgZnJvbSBcIi4vTW9kYWwuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vZGFsV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2NvbmZpcm1hdGlvbk1vZGFsRm9ybSA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgfVxyXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX3N1Ym1pdEFjdGlvbiA9IGFjdGlvbjtcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fY29uZmlybWF0aW9uTW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5fc3VibWl0QWN0aW9uKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IE1vZGFsIGZyb20gXCIuL01vZGFsLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNb2RhbFdpdGhJbWFnZSBleHRlbmRzIE1vZGFsIHtcclxuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZSA9IHRoaXMuX21vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlRGVzY3JpcHRpb24gPSB0aGlzLl9tb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5wcmV2aWV3X21vZGFsX2Rlc2NyaXB0aW9uXCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBvcGVuKGNhcmREYXRhKSB7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2Uuc3JjID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5hbHQgPSBjYXJkRGF0YS5hbHQ7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJjb25maWciLCJmb3JtRWxlbWVudCIsInRoaXMiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJfZXJyb3JFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImlkIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidGV4dENvbnRlbnQiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJhZGQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsImlucHV0TGlzdCIsInNvbWUiLCJfZGlzYWJsZUJ1dHRvbiIsIl9idXR0b25FbGVtZW50IiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZUJ1dHRvbiIsIl9zZXRFdmVudExpc3RlbmVyIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsImVuYWJsZUJ1dHRvbiIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlQ2FyZCIsIl9kYXRhIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2FsdCIsImFsdCIsIl9pZCIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJkb2N1bWVudCIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsIl9oYW5kbGVEZWxldGVDYXJkIiwiX2hhbmRsZUxpa2VDYXJkIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJfY2FyZEltYWdlRWxlbWVudCIsIl9jYXJkTmFtZUVsIiwiX2RlbGV0ZUJ1dHRvbiIsIl9saWtlQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiaGFuZGxlRGVsZXRlQnV0dG9uIiwiaGFuZGxlTGlrZUJ1dHRvbiIsInRvZ2dsZSIsIl91cGRhdGVMaWtlSWNvbiIsImdldENhcmRFbGVtZW50Iiwic3JjIiwiZ2V0SWQiLCJTZWN0aW9uIiwiX3JlZiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJbml0aWFsSXRlbXMiLCJhZGRJdGVtIiwiZWxlbWVudCIsIm5ld0NhcmQiLCJwcmVwZW5kIiwiYXBwZW5kIiwiTW9kYWwiLCJtb2RhbFNlbGVjdG9yIiwiX21vZGFsIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiTW9kYWxXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9tb2RhbEZvcm0iLCJfbW9kYWxCdXR0b24iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0TG9hZGluZyIsImlzTG9hZGluZyIsInRleHQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0Rm9ybSIsImZvcm1zIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlRGVzY3JpcHRpb25JbnB1dCIsInByb2ZpbGVBZGRCdXR0b24iLCJwcm9maWxlQWRkRm9ybSIsInByb2ZpbGVFZGl0QXZhdGFyQnV0dG9uIiwicHJvZmlsZUVkaXRBdmF0YXJGb3JtIiwiY29uZmlybWF0aW9uRm9ybSIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXIiLCJhdXRob3JpemF0aW9uIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiX2NoZWNrUmVzIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvIiwiaGVhZGVycyIsInVwZGF0ZVByb2ZpbGVJbmZvIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZVByb2ZpbGVBdmF0YXIiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJwb3N0Q2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwidXNlckluZm9DbGFzcyIsInByb2ZpbGVUaXRsZVNlbGVjdG9yIiwicHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3IiLCJwcm9maWxlQXZhdGFyU2VsZWN0b3IiLCJfcHJvZmlsZVRpdGxlRWxlbWVudCIsIl9wcm9maWxlRGVzY3JpcHRpb25FbGVtZW50IiwiX3Byb2ZpbGVBdmF0YXJFbGVtZW50IiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInRyaW0iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJfcmVmMiIsInByb2ZpbGVBZGRNb2RhbENsYXNzIiwib2JqIiwiY2FyZCIsInNlY3Rpb25DbGFzcyIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwiZmluYWxseSIsInJlc2V0IiwiZm9ybVZhbGlkYXRvcnMiLCJwcm9maWxlRWRpdE1vZGFsQ2xhc3MiLCJmb3JtRGF0YSIsInByb2ZpbGVFZGl0QXZhdGFyTW9kYWxDbGFzcyIsImNvbmZpcm1hdGlvbk1vZGFsQ2xhc3MiLCJfY29uZmlybWF0aW9uTW9kYWxGb3JtIiwic2V0U3VibWl0QWN0aW9uIiwiYWN0aW9uIiwiX3N1Ym1pdEFjdGlvbiIsInByZXZpZXdJbWFnZU1vZGFsQ2xhc3MiLCJfcHJldmlld0ltYWdlIiwiX3ByZXZpZXdJbWFnZURlc2NyaXB0aW9uIiwiY2FyZERhdGEiLCJlcnIiLCJjcmVhdGVDYXJkIiwiY2FyZExpc3QiLCJ1c2VyRGF0YSIsImZvcm1TZWxlY3RvciIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==